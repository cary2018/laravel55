<?php/** * Created by PhpStorm. * User: asusa * Date: 2018/4/13/0013 * Author: Cary.He * Contact QQ  : 373889161($S$-Memory) * email: 373889161@qq.com * Time: 11:51 */namespace App\Http\Controllers\Admin;use App\Http\Controllers\Controller;use App\Http\Model\Admin_user;use Illuminate\Support\Facades\Hash;use Illuminate\Support\Facades\Input;use Illuminate\Support\Facades\Validator;class AdminController extends Controller{    public function index()    {    }    /**     * 修改密码     */    public function pass()    {        if($input = Input::all()){            $rules = [                'password' => 'required',                'new_password' => 'required|confirmed|between:3,20',            ];            $messages = [                'password.required'=>'原始密码不能为空！',                'new_password.required'=>'新密码不能为空！',                'new_password.between'=>'新密码必需6到20位之间！',                'new_password.confirmed'=>'两次密码不一致！',            ];            $validator = Validator::make($input,$rules,$messages);            if($validator->passes()){                $user = Admin_user::where('id',session('user')->id)->first();                if ($user) {                    if (Hash::check($input['password'], $user->password)) {                        //return back()->with('mess','密码正确！');                        //session(['user' => $user]);   //保存用户登录信息                        //return redirect('admin/index');                        $user->password = Hash::make($input['new_password']);                        $user->update();                        return back()->with('errors', '密码修改成功！');                    } else {                        return back()->with('errors', '原始密码错误！');                    }                } else {                    return back()->with('errors', '登录失效，请重新登录！');                }                //dd($user);            }else{                return back()->withErrors($validator);            }        }        return view('admin.pass');    }}